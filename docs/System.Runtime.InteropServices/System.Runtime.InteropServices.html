<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../refdoc.css">
<title>Namespace: System.Runtime.InteropServices</title>
</head>
<body>
<h2>Namespace: System.Runtime.InteropServices</h2>
<dl>
<dd>
<p> The  <a href="../System.Runtime.InteropServices/System.Runtime.InteropServices.html">System.Runtime.InteropServices</a> namespace provides a collection of classes useful for accessing COM objects, and native APIs from .NET. The types in this namespace fall into the following areas of functionality: attributes, exceptions, managed definitions of COM types, wrappers, type converters, and the  <a href="../System.Runtime.InteropServices/types/Marshal.html">Marshal</a> class.</p>
<p></p>
<p> Many attributes are provided as a means of controlling marshaling behavior, such as how a structure should be arranged, or how a String should be represented. Of the most important attributes are , which is used to define methods that access native system APIs, and , which indicates how data should be marshaled between managed and unmanaged memory. Some attributes have corresponding enumerations that specify valid values for the attribute. They are listed below their associated attribute and are prefixed with the "-" character. The attributes provided by  are: </p>
<p> AutomationProxyAttribute </p>
<p> ClassInterfaceAttribute </p>
<p> -ClassInterfaceType </p>
<p> ComAliasNameAttribute </p>
<p> ComConvertionLossAttribute </p>
<p> ComImportAttribute </p>
<p> ComRegisterFunctionAttribute </p>
<p> ComSourceInterfacesAttribute </p>
<p> ComUnregisterFunctionAttribute </p>
<p> ComVisibleAttribute </p>
<p> DispIdAttribute </p>
<p> DllImportAttribute </p>
<p> -CallingConvention </p>
<p> -CharSet </p>
<p> FieldOffsetAttribute </p>
<p> GuidAttribute </p>
<p> IDispatchImplAttribute </p>
<p> -IDispatchImplType </p>
<p> ImportedFromTypeLibAttribute </p>
<p> InAttribute </p>
<p> InterfaceTypeAttribute </p>
<p> -ComInterfaceType </p>
<p> LCIDConvertionAttribute </p>
<p> MarshalAsAttribute </p>
<p> -VarEnum </p>
<p> -UnmanagedType </p>
<p> OptionalAttribute </p>
<p> OutAttribute </p>
<p> PreserveSigAttribute </p>
<p> PrimaryInteropAssemblyAttribute </p>
<p> ProdIdAttribute </p>
<p> StructLayoutAttribute </p>
<p> -CharSet </p>
<p> -LayoutKind </p>
<p> TypeLibFuncAttribute </p>
<p> -TypeLibFuncFlags </p>
<p> TypeLibTypeAttribute </p>
<p> -TypeLibTypeFlags </p>
<p> TypeLibVarAttribute </p>
<p> -TypeLibVarFlags </p>
<p> The exception classes provided by  indicate exceptional circumstances such as errors while performing certain operations, and serve as a way to bridge COM HRESULTs to .NET exceptions. The exceptions provided by  are: </p>
<p> COMException </p>
<p> ExternalException </p>
<p> InvalidComObjectException </p>
<p> InvalidOleVariantTypeException </p>
<p> MarshalDirectiveException </p>
<p> SafeArrayRankMismatchException </p>
<p> SafeArrayTypeMismatchException </p>
<p> SEHException </p>
<p> It is occasionally necessary to use existing COM types from managed code. To do so, a managed definition of the COM type must be available for the managed user to bind to. The  namespace provides managed definitions of a handful of useful interfaces. For detailed information on the types, refer to the existing documentation in the MSDN library. The COM types provided by  are: </p>
<p> BINDPTR </p>
<p> BIND_OPTS </p>
<p> CALLCONV </p>
<p> CONNECTDATA </p>
<p> DESCKIND </p>
<p> DISPPARAMS </p>
<p> ELEMDESC </p>
<p> ELEMDESC.DESCUNION </p>
<p> EXCEPINFO </p>
<p> FILETIME </p>
<p> FUNCDESC </p>
<p> FUNCFLAGS </p>
<p> FUNCKIND </p>
<p> IDLDESC </p>
<p> IDLFLAG </p>
<p> IMPLTYPEFLAGS </p>
<p> INVOKEKIND </p>
<p> LIBFLAGS </p>
<p> PARAMDESC </p>
<p> PARAMFLAG </p>
<p> STATSTG </p>
<p> SYSKIND </p>
<p> TYPEATTR </p>
<p> TYPEDESC </p>
<p> TYPEFLAGS </p>
<p> TYPEKIND </p>
<p> TYPELIBATTR </p>
<p> UCOMIBindCtx </p>
<p> UCOMIConnectionPoint </p>
<p> UCOMIConnectionPointContainer </p>
<p> UCOMIEnumConnectionPoints </p>
<p> UCOMIEnumConnections </p>
<p> UCOMIEnumMoniker </p>
<p> UCOMIEnumStream </p>
<p> UCOMIEnumVARIANT </p>
<p> UCOMIMoniker </p>
<p> UCOMIPersistFile </p>
<p> UCOMIRunningObjectTable </p>
<p> UCOMIStream </p>
<p> VARDESC </p>
<p> VARDESC.DESCUNION </p>
<p> VARFLAGS </p>
<p> When using COM Variants, it is sometimes necessary to wrap a COM type in a managed class in order to control the type of the Variant. Several wrappers have been designed to deal with these situations. The wrapper classes provided by  are: </p>
<p> CurrencyWrapper </p>
<p> DispatchWrapper </p>
<p> ErrorWrapper </p>
<p> UnknownWrapper </p>
<p> Although tools are provided in the .NET Framework SDK for registering types and converting between type libraries and assemblies, it is also possible to do the same conversion and registration tasks with the classes and interfaces found in the I  namespace. The conversion and registration classes provided by  are: </p>
<p> AssemblyRegistrationFlags </p>
<p> ExporterEventKind </p>
<p> ImporterEventKind </p>
<p> IRegistrationServices </p>
<p> ITypeLibConverter </p>
<p> ITypeLibExporterNotifySink </p>
<p> ITypeLibImporterNotifySink </p>
<p> RegistrationServices </p>
<p> TypeLibConverter </p>
<p> TypeLibExporterFlags </p>
<p> TypeLibImporterFlags </p>
<p> The  class is the largest class in, and most important part of, . It is used primarily for unmanaged memory operations and building custom marshalers, a bridge between managed and unmanaged code.</p>
</dd>
</dl>
<h3>Members of System.Runtime.InteropServices Namespace</h3><b>Classes</b><dl>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th bgcolor="#C0C0C0">Class</th>
<th bgcolor="#C0C0C0">
							Description
						</th>
</tr>
<tr valign="top">
<td width="30%"><a href="types/COMException.html">class COMException</a></td>
<td width="60%"> The exception thrown when an unrecognized HRESULT is returned from a COM method call. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/DllImportAttribute.html">class DllImportAttribute</a></td>
<td width="60%"> Indicates that the attributed method is implemented as an export from an unmanaged DLL. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/ExternalException.html">class ExternalException</a></td>
<td width="60%"> The base exception type for all COM interop exceptions and structured exception handling (SEH) exceptions. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/FieldOffsetAttribute.html">class FieldOffsetAttribute</a></td>
<td width="60%"> Indicates the physical position of fields within the unmanaged representation of a class or structure. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/InAttribute.html">class InAttribute</a></td>
<td width="60%"> Indicates that data should be marshaled from the caller to the callee. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/InvalidOleVariantTypeException.html">class InvalidOleVariantTypeException</a></td>
<td width="60%"> The exception thrown by the marshaler when it encounters an argument of a variant type that can not be marshaled to managed code. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/Marshal.html">class Marshal</a></td>
<td width="60%"> Provides a collection of methods pertaining to allocating unmanaged memory, copying unmanaged memory blocks, and converting managed to unmanaged types. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/MarshalAsAttribute.html">class MarshalAsAttribute</a></td>
<td width="60%"> Indicates how the data should be marshaled between managed and unmanaged code. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/MarshalDirectiveException.html">class MarshalDirectiveException</a></td>
<td width="60%"> The exception that is thrown by the marshaler when it encounters a  <a href="../System.Runtime.InteropServices/types/MarshalAsAttribute.html">MarshalAsAttribute</a> it does not support. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/OptionalAttribute.html">class OptionalAttribute</a></td>
<td width="60%"> Indicates that a parameter is optional. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/OutAttribute.html">class OutAttribute</a></td>
<td width="60%"> Indicates that data should be marshaled from callee back to caller. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/PreserveSigAttribute.html">class PreserveSigAttribute</a></td>
<td width="60%"> Indicates that the HRESULT or retval signature transformation that takes place during COM interop calls should be suppressed. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/RuntimeEnvironment.html">class RuntimeEnvironment</a></td>
<td width="60%"> Provides a collection of  methods that return information about the common language runtime environment. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/SEHException.html">class SEHException</a></td>
<td width="60%"> Represents Structured Exception Handler (SEH) errors. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/StructLayoutAttribute.html">class StructLayoutAttribute</a></td>
<td width="60%"> The  class allows the user to control the physical layout of the data fields of a class or structure. 
     </td>
</tr>
</table>
</dd>
</dl><br><b>Interfaces</b><dl>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th bgcolor="#C0C0C0">Interface</th>
<th bgcolor="#C0C0C0">
							Description
						</th>
</tr>
<tr valign="top">
<td width="30%"><a href="types/ICustomMarshaler.html">interface ICustomMarshaler</a></td>
<td width="60%"> Designed to provide custom wrappers for handling method calls. 
     </td>
</tr>
</table>
</dd>
</dl><br><b>Structures</b><dl>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th bgcolor="#C0C0C0">Structure</th>
<th bgcolor="#C0C0C0">
							Description
						</th>
</tr>
<tr valign="top">
<td width="30%"><a href="types/ArrayWithOffset.html">structure ArrayWithOffset</a></td>
<td width="60%"> Encapsulates an array and an offset within the specified array. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/GCHandle.html">structure GCHandle</a></td>
<td width="60%"> Provides a means for accessing a managed object from unmanaged memory. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/HandleRef.html">structure HandleRef</a></td>
<td width="60%"> Wraps a managed object holding a handle to a resource that is passed to unmanaged code using platform invoke. 
     </td>
</tr>
</table>
</dd>
</dl><br><b>Enumerations</b><dl>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th bgcolor="#C0C0C0">Enumeration</th>
<th bgcolor="#C0C0C0">
							Description
						</th>
</tr>
<tr valign="top">
<td width="30%"><a href="types/CallingConvention.html">enumeration CallingConvention</a></td>
<td width="60%"> Specifies the calling convention required to call methods implemented in unmanaged code. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/CharSet.html">enumeration CharSet</a></td>
<td width="60%"> Dictates which character set marshaled strings should use. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/GCHandleType.html">enumeration GCHandleType</a></td>
<td width="60%"> Represents the types of handles the  <a href="../System.Runtime.InteropServices/types/GCHandle.html">GCHandle</a> class can allocate. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/LayoutKind.html">enumeration LayoutKind</a></td>
<td width="60%"> Controls the layout of an object when exported to unmanaged code. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/UnmanagedType.html">enumeration UnmanagedType</a></td>
<td width="60%"> Identifies how parameters or fields should be marshaled to unmanaged code. 
     </td>
</tr>
<tr valign="top">
<td width="30%"><a href="types/VarEnum.html">enumeration VarEnum</a></td>
<td width="60%"> Indicates how the array elements should be marshaled when an array is marshaled from managed to unmanaged code as a  <a><font color="#FF0000"><i>System.Runtime.InteropServices.UnmanagedType.SafeArray</i> (not supported on the shared source CLI) </font></a>. 
     </td>
</tr>
</table>
</dd>
</dl><br><b>Namepace hierarchy</b><br><ul class="none">
<li><a href="../System/types/Object.html">System.Object</a></li>
<ul class="none">
<li><a href="../System/types/Attribute.html">System.Attribute</a></li>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/DllImportAttribute.html">System.Runtime.InteropServices.DllImportAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/FieldOffsetAttribute.html">System.Runtime.InteropServices.FieldOffsetAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/InAttribute.html">System.Runtime.InteropServices.InAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/MarshalAsAttribute.html">System.Runtime.InteropServices.MarshalAsAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/OptionalAttribute.html">System.Runtime.InteropServices.OptionalAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/OutAttribute.html">System.Runtime.InteropServices.OutAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/PreserveSigAttribute.html">System.Runtime.InteropServices.PreserveSigAttribute</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/StructLayoutAttribute.html">System.Runtime.InteropServices.StructLayoutAttribute</a></li>
</ul>
</ul>
<ul class="none">
<li><a href="../System/types/Exception.html">System.Exception</a></li>
<ul class="none">
<li><a href="../System/types/SystemException.html">System.SystemException</a></li>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/ExternalException.html">System.Runtime.InteropServices.ExternalException</a></li>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/COMException.html">System.Runtime.InteropServices.COMException</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/SEHException.html">System.Runtime.InteropServices.SEHException</a></li>
</ul>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/InvalidOleVariantTypeException.html">System.Runtime.InteropServices.InvalidOleVariantTypeException</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/MarshalDirectiveException.html">System.Runtime.InteropServices.MarshalDirectiveException</a></li>
</ul>
</ul>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/Marshal.html">System.Runtime.InteropServices.Marshal</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/RuntimeEnvironment.html">System.Runtime.InteropServices.RuntimeEnvironment</a></li>
</ul>
<ul class="none">
<li><a href="../System/types/ValueType.html">System.ValueType</a></li>
<ul class="none">
<li><a href="../System/types/Enum.html">System.Enum</a></li>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/CallingConvention.html">System.Runtime.InteropServices.CallingConvention</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/CharSet.html">System.Runtime.InteropServices.CharSet</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/GCHandleType.html">System.Runtime.InteropServices.GCHandleType</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/LayoutKind.html">System.Runtime.InteropServices.LayoutKind</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/UnmanagedType.html">System.Runtime.InteropServices.UnmanagedType</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/VarEnum.html">System.Runtime.InteropServices.VarEnum</a></li>
</ul>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/ArrayWithOffset.html">System.Runtime.InteropServices.ArrayWithOffset</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/GCHandle.html">System.Runtime.InteropServices.GCHandle</a></li>
</ul>
<ul class="none">
<li><a href="../System.Runtime.InteropServices/types/HandleRef.html">System.Runtime.InteropServices.HandleRef</a></li>
</ul>
</ul>
</ul><br><i><a href="../documentation_license.txt">
				  Copyright (c) 2002 Microsoft Corporation.  All rights reserved.
				</a></i></body>
</html>
