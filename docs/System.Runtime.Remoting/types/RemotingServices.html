<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../refdoc.css">
<title>Type: System.Runtime.Remoting.RemotingServices</title>
</head>
<body><a name="TopOfPage"></a><h2>System.Runtime.Remoting.RemotingServices Class</h2><b>Assembly: </b>Mscorlib.dll<br><b>Namespace: </b>System.Runtime.Remoting<br><dl>
<dt><b>Summary</b></dt>
<dd> Provides several methods for using and publishing remoted objects and proxies. This class cannot be inherited.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
        public sealed class RemotingServices
      </b></code></td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> Unless you are a service provider dealing with issues such as activation, lifetime management, or transactions, you do not need to distinguish between proxy references and object references. The remoting infrastructure uses transparent proxies that give the impression that the remote objects reside in the client's space. Proxies achieve this by forwarding calls made on them to the real objects at remote locations.</dd>
</dl><b>See also: </b><dl>
<dd> <a href="../../System.Runtime.Remoting/System.Runtime.Remoting.html">System.Runtime.Remoting Namespace</a></dd>
</dl>
<h3>System.Runtime.Remoting.RemotingServices Member List: </h3>
<dl>
<dt><b>Public Methods</b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<td width="35%"><a href="#Connect(System.Type,System.String)">Connect</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Connect(Type classToProxy, string url)<br><br></code> Takes in the  <a href="../../System/types/Type.html">Type</a> and URL of the well-known object to which you want to connect to, and creates a proxy object for it.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Connect(System.Type,System.String,System.Object)">Connect</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Connect(Type classToProxy, string url, object data)<br><br></code> Takes in the  <a href="../../System/types/Type.html">Type</a> and URL of the well-known object to which you want to connect, and as well as channel specific data, and creates a proxy for it.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Disconnect(System.MarshalByRefObject)">Disconnect</a></td>
<td width="55%"> Stops an object from receiving any further messages through the registered remoting channels.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Equals(System.Object)">Equals</a><br>(inherited from <b>System.Object)</b></td>
<td width="55%"><b><font color="#800080">See base class member description: <a href="../../System/types/Object.html#Equals(System.Object)">System.Object.Equals</a></font></b><br><br>Derived from System.Object, the primary base class for all objects.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#ExecuteMessage(System.MarshalByRefObject,System.Runtime.Remoting.Messaging.IMethodCallMessage)">ExecuteMessage</a></td>
<td width="55%"> Connects to the specified remote object, and executes the provided  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodCallMessage.html">IMethodCallMessage</a> on it.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetEnvoyChainForProxy(System.MarshalByRefObject)">GetEnvoyChainForProxy</a></td>
<td width="55%"> Returns a chain of envoy sinks that should be used when sending messages to the remote object represented by the specified proxy.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetHashCode">GetHashCode</a><br>(inherited from <b>System.Object)</b></td>
<td width="55%"><b><font color="#800080">See base class member description: <a href="../../System/types/Object.html#GetHashCode">System.Object.GetHashCode</a></font></b><br><br>Derived from System.Object, the primary base class for all objects.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetLifetimeService(System.MarshalByRefObject)">GetLifetimeService</a></td>
<td width="55%"> Returns a lifetime service object that controls the lifetime policy of the specified object.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetMethodBaseFromMethodMessage(System.Runtime.Remoting.Messaging.IMethodMessage)">GetMethodBaseFromMethodMessage</a></td>
<td width="55%"> Returns the method base from the given  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a>.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetObjectData(System.Object,System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)">GetObjectData</a></td>
<td width="55%"> Serializes the specified marshal by reference object into the provided  <a href="../../System.Runtime.Serialization/types/SerializationInfo.html">SerializationInfo</a>.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetObjectUri(System.MarshalByRefObject)">GetObjectUri</a></td>
<td width="55%"> Retrieves the URI for the specified object.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetObjRefForProxy(System.MarshalByRefObject)">GetObjRefForProxy</a></td>
<td width="55%"> Returns the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> that represents the remote object from the specified proxy.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetRealProxy(System.Object)">GetRealProxy</a></td>
<td width="55%"> Returns the real proxy backing the specified transparent proxy.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetServerTypeForUri(System.String)">GetServerTypeForUri</a></td>
<td width="55%"> Returns the  <a href="../../System/types/Type.html">Type</a> of the object with the specified URI.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetSessionIdForMethodMessage(System.Runtime.Remoting.Messaging.IMethodMessage)">GetSessionIdForMethodMessage</a></td>
<td width="55%"> Retrieves a session ID for a message.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetType">GetType</a><br>(inherited from <b>System.Object)</b></td>
<td width="55%"><b><font color="#800080">See base class member description: <a href="../../System/types/Object.html#GetType">System.Object.GetType</a></font></b><br><br>Derived from System.Object, the primary base class for all objects.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#IsMethodOverloaded(System.Runtime.Remoting.Messaging.IMethodMessage)">IsMethodOverloaded</a></td>
<td width="55%"> Returns a Boolean value indicating whether the method in the given message is overloaded.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#IsObjectOutOfAppDomain(System.Object)">IsObjectOutOfAppDomain</a></td>
<td width="55%"> Returns a Boolean value indicating whether the object specified by the given transparent proxy is contained in a different AppDomain than the object that called the current method.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#IsObjectOutOfContext(System.Object)">IsObjectOutOfContext</a></td>
<td width="55%"> Returns a Boolean value indicating whether the object represented by the given proxy is contained in a different context than the object that called the current method.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#IsOneWay(System.Reflection.MethodBase)">IsOneWay</a></td>
<td width="55%"> Returns a Boolean value indicating whether the client that called the method specified in the given message is waiting for the server to finish processing the method before continuing execution.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#IsTransparentProxy(System.Object)">IsTransparentProxy</a></td>
<td width="55%"> Returns a Boolean value indicating whether the given object is a transparent proxy or a real object.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#LogRemotingStage(System.Int32)">LogRemotingStage</a></td>
<td width="55%"> Public reserved method, for internal use only.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Marshal(System.MarshalByRefObject)">Marshal</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Marshal(MarshalByRefObject Obj)<br><br></code> Takes a  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a>, registers it with the remoting infrastructure, and converts it into an instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Marshal(System.MarshalByRefObject,System.String)">Marshal</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Marshal(MarshalByRefObject Obj, string URI)<br><br></code> Converts the given  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> into an instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class with the specified URI.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Marshal(System.MarshalByRefObject,System.String,System.Type)">Marshal</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Marshal(MarshalByRefObject Obj, string ObjURI, Type RequestedType)<br><br></code> Takes a  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> and converts it into an instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class with the specified URI, and the provided  <a href="../../System/types/Type.html">Type</a>.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#SetObjectUriForMarshal(System.MarshalByRefObject,System.String)">SetObjectUriForMarshal</a></td>
<td width="55%"> Sets the URI for the subsequent call to the  <a href="#Marshal(System.MarshalByRefObject)">RemotingServices.Marshal</a> method.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#ToString">ToString</a><br>(inherited from <b>System.Object)</b></td>
<td width="55%"><b><font color="#800080">See base class member description: <a href="../../System/types/Object.html#ToString">System.Object.ToString</a></font></b><br><br>Derived from System.Object, the primary base class for all objects.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Unmarshal(System.Runtime.Remoting.ObjRef)">Unmarshal</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Unmarshal(ObjRef objectRef)<br><br></code> Takes an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> and creates a proxy object out of it.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#Unmarshal(System.Runtime.Remoting.ObjRef,System.Boolean)">Unmarshal</a></td>
<td width="55%"><b>Overloaded:</b><br><code>Unmarshal(ObjRef objectRef, bool fRefine)<br><br></code> Takes an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> and creates a proxy object out of it, refining it to the type on the server.</td>
</tr>
</table>
</dd>
</dl>
<dl>
<dt><b>Protected Methods</b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<td width="35%"><a href="#Finalize">Finalize</a><br>(inherited from <b>System.Object)</b></td>
<td width="55%"><b><font color="#800080">See base class member description: <a href="../../System/types/Object.html#Finalize">System.Object.Finalize</a></font></b><br><br>Derived from System.Object, the primary base class for all objects.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#MemberwiseClone">MemberwiseClone</a><br>(inherited from <b>System.Object)</b></td>
<td width="55%"><b><font color="#800080">See base class member description: <a href="../../System/types/Object.html#MemberwiseClone">System.Object.MemberwiseClone</a></font></b><br><br>Derived from System.Object, the primary base class for all objects.</td>
</tr>
</table>
</dd>
</dl>
<p><b>Hierarchy:</b><ul class="none">
<li><a href="../../System/types/Object.html">System.Object</a></li>
<ul class="none">
<li><b>System.Runtime.Remoting.RemotingServices</b></li>
</ul>
</ul>
</p>
<hr>
<h3>System.Runtime.Remoting.RemotingServices Member Details</h3><b>Overloaded Method: <i><a name="ConnectTopic1"></a><a name="Connect(System.Type,System.String)">Connect</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Type.html">Type</a> <i>classToProxy</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>url</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Takes in the  <a href="../../System/types/Type.html">Type</a> and URL of the well-known object to which you want to connect to, and creates a proxy object for it.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Object.html">object</a> Connect(<br>   <font color="#008080"><a href="../../System/types/Type.html">Type</a> <i>classToProxy</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>url</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>classToProxy</i><br><dl>
<dd>
<param> The  <a href="../../System/types/Type.html">Type</a> of a well-known object on the server end to which you want to connect.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>url</i><br><dl>
<dd>
<param> The URL of the server class.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A proxy to the remote object that points to an endpoint served by the specified well-known object.</dd>
</dl><b>Remarks</b><dl>
<dd> The returned proxy object points to an endpoint served by the specified well-known object. No messages are sent over the network until a method is called on the proxy.</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to use the  <a href="#Connect(System.Type,System.String)">RemotingServices.Connect</a> method to create a proxy to a well-known object.<pre>
      Console.WriteLine("Connecting to SampleNamespace.SampleWellKnown.");
      
      SampleWellKnown proxy = 
         (SampleWellKnown)RemotingServices.Connect(typeof(SampleWellKnown), SERVER_URL);

      Console.WriteLine("Connected to SampleWellKnown");
      
      // Verifies that the object reference is to a transparent proxy.
      if (RemotingServices.IsTransparentProxy(proxy))
          Console.WriteLine("proxy is a reference to a transparent proxy.");
      else
          Console.WriteLine("proxy is not a transparent proxy.  This is unexpected.");
      
      // Calls a method on the server object.
      Console.WriteLine("proxy.Add returned {0}.", proxy.Add(2, 3));

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Overloaded Method: <i><a name="ConnectTopic2"></a><a name="Connect(System.Type,System.String,System.Object)">Connect</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Type.html">Type</a> <i>classToProxy</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>url</i>,</font><br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>data</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Takes in the  <a href="../../System/types/Type.html">Type</a> and URL of the well-known object to which you want to connect, and as well as channel specific data, and creates a proxy for it.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Object.html">object</a> Connect(<br>   <font color="#008080"><a href="../../System/types/Type.html">Type</a> <i>classToProxy</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>url</i>,</font><br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>data</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>classToProxy</i><br><dl>
<dd>
<param> The  <a href="../../System/types/Type.html">Type</a> of the well-known object to which you want to connect.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>url</i><br><dl>
<dd>
<param> The URL of the well-known object.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>data</i><br><dl>
<dd>
<param> Channel specific data. Can be <b>null</b>.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A proxy that points to an endpoint that is served by the requested well-known object.</dd>
</dl><b>Remarks</b><dl>
<dd> The returned proxy object points to an endpoint served by the specified well-known object. No messages are sent over the network until a method is called on the proxy.<p> The <i>data</i> object is used to communicate information to the channel, and is passed to the  <a href="../../System.Runtime.Remoting.Channels/types/IChannelSender.html#CreateMessageSink(System.String,System.Object,System.String@)">IChannelSender.CreateMessageSink</a> method.</p>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="DisconnectTopic1"></a><a name="Disconnect(System.MarshalByRefObject)">Disconnect</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Stops an object from receiving any further messages through the registered remoting channels.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Boolean.html">bool</a> Disconnect(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> Object to disconnect from its channel.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd><b>true</b> if the object was disconnected from the registered remoting channels successfully; otherwise, <b>false</b>.</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentNullException.html">ArgumentNullException</a></td>
<td> The <i>obj</i> parameter is <b>null</b>.</td>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentException.html">ArgumentException</a></td>
<td> The <i>obj</i> parameter is a proxy.</td>
</tr>
</table>
</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to use the  <a href="#Disconnect(System.MarshalByRefObject)">RemotingServices.Disconnect</a> method to disconnect an object from the remoting channels.<pre>
      TcpChannel channel = new TcpChannel(9000);
      ChannelServices.RegisterChannel(channel);

      SampleWellKnown objectWellKnown = new SampleWellKnown();
      
      // After the channel is registered, the object needs to be registered
      // with the remoting infrastructure.  So, Marshal is called.
      ObjRef objrefWellKnown = RemotingServices.Marshal(objectWellKnown, "objectWellKnownUri");
      Console.WriteLine("An instance of SampleWellKnown type is published at {0}.", objrefWellKnown.URI);

      Console.WriteLine("Press enter to unregister SampleWellKnown, so that it is no longer available on this channel.");
      Console.ReadLine();
      RemotingServices.Disconnect(objectWellKnown);

      Console.WriteLine("Press enter to end the server process.");
      Console.ReadLine();

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="EqualsTopic1"></a><a name="Equals(System.Object)">Equals</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>obj</i></font><br>)</i></b><dl>
<dd><b><font color="#800080"> Inherited<br>See base class member description: <a href="../../System/types/Object.html#Equals(System.Object)">System.Object.Equals</a></font></b></dd>
</dl>
<dl>
<dd>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public virtual <a href="../../System/types/Boolean.html">bool</a> Equals(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><br>For more information on members inherited from System.Object click on the link above.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="ExecuteMessageTopic1"></a><a name="ExecuteMessage(System.MarshalByRefObject,System.Runtime.Remoting.Messaging.IMethodCallMessage)">ExecuteMessage</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>target</i>,</font><br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodCallMessage.html">IMethodCallMessage</a> <i>reqMsg</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Connects to the specified remote object, and executes the provided  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodCallMessage.html">IMethodCallMessage</a> on it.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System.Runtime.Remoting.Messaging/types/IMethodReturnMessage.html">IMethodReturnMessage</a> ExecuteMessage(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>target</i>,</font><br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodCallMessage.html">IMethodCallMessage</a> <i>reqMsg</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>target</i><br><dl>
<dd>
<param> The remote object whose method you want to call.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>reqMsg</i><br><dl>
<dd>
<param> A method call message to the specified remote object's method.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The response of the remote method.</dd>
</dl><b>Remarks</b><dl>
<dd> The current method is used in special cases by the server to forward the specified method call to another, possibly remote, object. This method can be called only when the caller is in the appropriate context.</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to use the  <a href="#ExecuteMessage(System.MarshalByRefObject,System.Runtime.Remoting.Messaging.IMethodCallMessage)">RemotingServices.ExecuteMessage</a> method to forward method calls to remote objects.<pre>
   public void ProcessMessageStart(IMessage requestMessage, bool bClientSide, bool bAsyncCall) {
      
      Console.WriteLine("\nProcessMessageStart");
      Console.WriteLine("requestMessage = {0}", requestMessage);
      
      try {
         Console.WriteLine("SessionId = {0}.",
             RemotingServices.GetSessionIdForMethodMessage((IMethodMessage)requestMessage));
      }
      catch (InvalidCastException) {
         Console.WriteLine("The requestMessage is not an IMethodMessage.");
      }

      IMethodCallMessage requestMethodCallMessage;
      
      try {
         requestMethodCallMessage = (IMethodCallMessage)requestMessage;
         // Prints the details of the IMethodCallMessage to the console.
         Console.WriteLine("\nMethodCall details");
         Console.WriteLine("Uri = {0}", requestMethodCallMessage.Uri);
         Console.WriteLine("TypeName = {0}", requestMethodCallMessage.TypeName);
         Console.WriteLine("MethodName = {0}", requestMethodCallMessage.MethodName);
         Console.WriteLine("ArgCount = {0}", requestMethodCallMessage.ArgCount);
         
         Console.WriteLine("MethodCall.Args");
         foreach(object o in requestMethodCallMessage.Args)
             Console.WriteLine("\t{0}", o);
         
         // Sends this method call message to another server to replicate
         // the call at the second server.
         if (requestMethodCallMessage.Uri == replicatedServiceUri) {
            
            SampleService replicationService = 
               (SampleService)Activator.GetObject(typeof(SampleService), 
               replicationServerUrl + replicatedServiceUri);
            
            IMethodReturnMessage returnMessage = 
               RemotingServices.ExecuteMessage(replicationService, requestMethodCallMessage);
            
            // Prints the results of the method call stored in the IMethodReturnMessage.
            Console.WriteLine("\nMessage returned by ExecuteMessage.");
            Console.WriteLine("\tException = {0}", returnMessage.Exception);
            Console.WriteLine("\tReturnValue = {0}", returnMessage.ReturnValue);
            Console.WriteLine("\tOutArgCount = {0}", returnMessage.OutArgCount);
            Console.WriteLine("Return message OutArgs");
            
            foreach(object o in requestMethodCallMessage.Args)
               Console.WriteLine("\t{0}", o);
         }
      }
      catch (InvalidCastException) {
          Console.WriteLine("The requestMessage is not a MethodCall");
      }
   }

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="FinalizeTopic1"></a><a name="Finalize">Finalize</a></i></b><b><i>()</i></b><dl>
<dd><b><font color="#800080"> Inherited<br>See base class member description: <a href="../../System/types/Object.html#Finalize">System.Object.Finalize</a></font></b></dd>
</dl>
<dl>
<dd>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            ~RemotingServices();</b></code></td>
</tr>
</table>
</dd>
</dl><br>For more information on members inherited from System.Object click on the link above.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetEnvoyChainForProxyTopic1"></a><a name="GetEnvoyChainForProxy(System.MarshalByRefObject)">GetEnvoyChainForProxy</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a chain of envoy sinks that should be used when sending messages to the remote object represented by the specified proxy.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System.Runtime.Remoting.Messaging/types/IMessageSink.html">IMessageSink</a> GetEnvoyChainForProxy(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> The proxy of the remote object that requested envoy sinks are associated with.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A chain of envoy sinks associated with the specified proxy.</dd>
</dl><b>Remarks</b><dl>
<dd> Envoy sinks are sinks sent along with the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> of an object that is used when returning messages to that object. The current method returns the envoy sinks that are used during communication between the proxy of the object and the object itself.</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Remoting/types/IEnvoyInfo.html">IEnvoyInfo</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetHashCodeTopic1"></a><a name="GetHashCode">GetHashCode</a></i></b><b><i>()</i></b><dl>
<dd><b><font color="#800080"> Inherited<br>See base class member description: <a href="../../System/types/Object.html#GetHashCode">System.Object.GetHashCode</a></font></b></dd>
</dl>
<dl>
<dd>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public virtual <a href="../../System/types/Int32.html">int</a> GetHashCode();</b></code></td>
</tr>
</table>
</dd>
</dl><br>For more information on members inherited from System.Object click on the link above.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetLifetimeServiceTopic1"></a><a name="GetLifetimeService(System.MarshalByRefObject)">GetLifetimeService</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a lifetime service object that controls the lifetime policy of the specified object.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Object.html">object</a> GetLifetimeService(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> The object to obtain lifetime service for.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The object that controls the lifetime of <i>obj</i>.</dd>
</dl><b>Remarks</b><dl>
<dd> For the default lifetime service the returned object will be an object of type  <a href="../../System.Runtime.Remoting.Lifetime/types/ILease.html">ILease</a>. If the <i>obj</i> parameter is <b>null</b>, the method returns <b>null</b>.</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to use the  <a href="#GetLifetimeService(System.MarshalByRefObject)">RemotingServices.GetLifetimeService</a> method to get a lifetime lease for the specified object.<pre>
using System;
using System.Net.Sockets;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Http;
using System.Runtime.Remoting.Messaging;
using System.Runtime.Remoting.Lifetime;
using TimerSample;

namespace GroupCoffeeTimer {
    public class TimerClient : MarshalByRefObject, ISponsor {
        public static void Main() {
            TimerClient myClient = new TimerClient();
        }

        public TimerClient() {
            // Registers the HTTP Channel so that this client can receive
            // events from the remote service.
            ChannelServices.RegisterChannel(new HttpChannel(0));
            WellKnownClientTypeEntry remoteType = new WellKnownClientTypeEntry(typeof(TimerService), "http://localhost:9000/MyService/TimerService.soap");
            RemotingConfiguration.RegisterWellKnownClientType(remoteType);
            
            TimerService groupTimer = new TimerService();
            groupTimer.MinutesToTime = 4.0; 

            // Registers this client as a lease sponsor so that it can
            // prevent the expiration of the TimerService.
            ILease leaseObject = (ILease)RemotingServices.GetLifetimeService(groupTimer);
            leaseObject.Register(this);
            
            // Subscribes to the event so that the client can receive notifications from the server.
            groupTimer.TimerExpired += new TimerExpiredEventHandler(OnTimerExpired);
            Console.WriteLine("Connected to TimerExpired event");
            
            groupTimer.Start();
            Console.WriteLine("Timer started for {0} minutes.", groupTimer.MinutesToTime);
            Console.WriteLine("Press enter to end the client process.");
            Console.ReadLine();
        }
        
        public void OnTimerExpired (object source, TimerServiceEventArgs e) {
            Console.WriteLine("TimerHelper.OnTimerExpired: {0}", e.Message);
        }

        public TimeSpan Renewal(ILease lease) {
            Console.WriteLine("TimerClient: Renewal called.");
            return TimeSpan.FromMinutes(0.5);
        }
    }
}

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetMethodBaseFromMethodMessageTopic1"></a><a name="GetMethodBaseFromMethodMessage(System.Runtime.Remoting.Messaging.IMethodMessage)">GetMethodBaseFromMethodMessage</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> <i>msg</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns the method base from the given  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a>.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System.Reflection/types/MethodBase.html">MethodBase</a> GetMethodBaseFromMethodMessage(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> <i>msg</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>msg</i><br><dl>
<dd>
<param> The method message to extract the method base from.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The method base extracted from the <i>msg</i> parameter.</dd>
</dl><b>Remarks</b><dl>
<dd> This determines the method base from the  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html#TypeName">IMethodMessage.TypeName</a>,  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html#MethodName">IMethodMessage.MethodName</a>, and  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html#MethodSignature">IMethodMessage.MethodSignature</a> properties of  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> and is used by classes implementing the  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> interface. Consumers of  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> classes should reference the  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html#MethodBase">IMethodMessage.MethodBase</a> property.</dd>
</dl><b>.NET Framework Security:</b><dl>
<dd> <a href="../../System.Security.Permissions/types/ReflectionPermission.html">ReflectionPermission</a> for extraction of reflection information on members of a type that are not visible. Associated enumeration:  <a href="../../System.Security.Permissions/types/ReflectionPermissionFlag.html#TypeInformation">ReflectionPermissionFlag.TypeInformation</a>.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetObjectDataTopic1"></a><a name="GetObjectData(System.Object,System.Runtime.Serialization.SerializationInfo,System.Runtime.Serialization.StreamingContext)">GetObjectData</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>obj</i>,</font><br>   <font color="#008080"><a href="../../System.Runtime.Serialization/types/SerializationInfo.html">SerializationInfo</a> <i>info</i>,</font><br>   <font color="#008080"><a href="../../System.Runtime.Serialization/types/StreamingContext.html">StreamingContext</a> <i>context</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Serializes the specified marshal by reference object into the provided  <a href="../../System.Runtime.Serialization/types/SerializationInfo.html">SerializationInfo</a>.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static void GetObjectData(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>obj</i>,</font><br>   <font color="#008080"><a href="../../System.Runtime.Serialization/types/SerializationInfo.html">SerializationInfo</a> <i>info</i>,</font><br>   <font color="#008080"><a href="../../System.Runtime.Serialization/types/StreamingContext.html">StreamingContext</a> <i>context</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> The object to serialize.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>info</i><br><dl>
<dd>
<param> The  <a href="../../System.Runtime.Serialization/types/SerializationInfo.html">SerializationInfo</a> into which the object is serialized.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>context</i><br><dl>
<dd>
<param> The source and destination of the serialization.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentNullException.html">ArgumentNullException</a></td>
<td> The <i>obj</i> or <i>info</i> parameter is <b>null</b>.</td>
</tr>
</table>
</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Serialization/types/ISerializable.html">ISerializable</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetObjectUriTopic1"></a><a name="GetObjectUri(System.MarshalByRefObject)">GetObjectUri</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Retrieves the URI for the specified object.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/String.html">string</a> GetObjectUri(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> The  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> for which a URI is requested.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The URI of the specified object if it has one, or <b>null</b> if the object has not yet been marshaled.</dd>
</dl><b>Example</b><dl>
<dd>
<pre>
      RealProxy proxy = RemotingServices.GetRealProxy(obj);
      Console.WriteLine("Real proxy type: {0}", proxy.GetProxiedType().ToString());

      Console.WriteLine("Object URI: {0}", RemotingServices.GetObjectUri(obj).ToString());

      IMessageSink  msgSink = RemotingServices.GetEnvoyChainForProxy(obj).NextSink;

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetObjRefForProxyTopic1"></a><a name="GetObjRefForProxy(System.MarshalByRefObject)">GetObjRefForProxy</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> that represents the remote object from the specified proxy.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> GetObjRefForProxy(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> A proxy connected to the object you want to create an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> representing the remote object the specified proxy is connected to, or <b>null</b> if the object or proxy have not been marshaled.</dd>
</dl><b>Remarks</b><dl>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is a serializable representation of an object used to transfer an object reference across an AppDomain boundary. Creating an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for an object is known as marshaling. The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> can be transferred through a channel into another AppDomain (possibly on another process or computer). Once in the other AppDomain, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> must be parsed to create a proxy for the object, generally connected to the real object. This operation is known as unmarshaling. During unmarshaling, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is parsed to extract the method information of the remote object and both the transparent proxy and  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> objects are created.<p> <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> s contain information that describes the  <a href="../../System/types/Type.html">Type</a> and class of the object being marshaled, a URI that uniquely identifies the specific object instance, and communication related information on how to reach the remote application where the object is located.</p>
</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to get an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> instance for the specified object.<pre>
        ObjRef objRefSample = RemotingServices.GetObjRefForProxy(myRemoteObject);
        
        Console.WriteLine("***ObjRef Details***");
        Console.WriteLine("URI:\t{0}", objRefSample.URI);
        
        object[] channelData = objRefSample.ChannelInfo.ChannelData;
        
        Console.WriteLine("Channel Info:");
        foreach(object o in channelData)
            Console.WriteLine("\t{0}", o.ToString());
        
        IEnvoyInfo envoyInfo = objRefSample.EnvoyInfo;
        
        if (envoyInfo == null) {
            Console.WriteLine("This ObjRef does not have envoy information.");
        }
        else {
            IMessageSink envoySinks = envoyInfo.EnvoySinks;
            Console.WriteLine("Envoy Sink Class: {0}", envoySinks);
        }
        
        IRemotingTypeInfo typeInfo = objRefSample.TypeInfo;
        Console.WriteLine("Remote type name: {0}", typeInfo.TypeName);
        
        Console.WriteLine("Can my object cast to a Bitmap? {0}",
            typeInfo.CanCastTo(typeof(System.Drawing.Bitmap), objRefSample));

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetRealProxyTopic1"></a><a name="GetRealProxy(System.Object)">GetRealProxy</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>proxy</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns the real proxy backing the specified transparent proxy.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> GetRealProxy(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>proxy</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>proxy</i><br><dl>
<dd>
<param> A transparent proxy.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The real proxy instance backing the transparent proxy.</dd>
</dl><b>Remarks</b><dl>
<dd> A client that uses an object across any kind of remoting boundary is actually using a transparent proxy for the object. The transparent proxy gives the impression that the actual object resides in the client's space. It achieves this by forwarding calls made on it to the real object using the remoting infrastructure.<p> The transparent proxy is backed by an instance of a managed runtime class of type  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a>. The  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> implements a part of the functionality needed to forward the operations from the transparent proxy. Note that a proxy object inherits the associated semantics of managed objects such as garbage collection, support for fields and methods, and can be extended to form new classes. The proxy acts as an object of the same class as the remote object (transparent proxy), and is also a managed object.</p>
</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetServerTypeForUriTopic1"></a><a name="GetServerTypeForUri(System.String)">GetServerTypeForUri</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>URI</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns the  <a href="../../System/types/Type.html">Type</a> of the object with the specified URI.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Type.html">Type</a> GetServerTypeForUri(<br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>URI</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>URI</i><br><dl>
<dd>
<param> The URI of the object whose  <a href="../../System/types/Type.html">Type</a> is requested.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The  <a href="../../System/types/Type.html">Type</a> of the object with the specified URI.</dd>
</dl><b>Remarks</b><dl>
<dd> Since remoting identifies endpoints using URIs, the  <a href="#GetServerTypeForUri(System.String)">RemotingServices.GetServerTypeForUri</a> method is very useful in the pluggable parts of the remoting infrastructure (for example channel sinks, dynamic sinks, and context sinks) that use  <a href="../../System.Runtime.Remoting.Messaging/types/IMessage.html">IMessage</a> objects, since the current method will return the associated type object from the URI.</dd>
</dl><b>Example</b><dl>
<dd>
<pre>
      Console.WriteLine("Server type: {0}",
                        RemotingServices.GetServerTypeForUri(myObjectUri));

    </pre>
</dd>
</dl><b>.NET Framework Security:</b><dl>
<dd> <a href="../../System.Security.Permissions/types/ReflectionPermission.html">ReflectionPermission</a> for extraction of reflection information on members of a type that are not visible. Associated enumeration:  <a href="../../System.Security.Permissions/types/ReflectionPermissionFlag.html#TypeInformation">ReflectionPermissionFlag.TypeInformation</a>.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetSessionIdForMethodMessageTopic1"></a><a name="GetSessionIdForMethodMessage(System.Runtime.Remoting.Messaging.IMethodMessage)">GetSessionIdForMethodMessage</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> <i>msg</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Retrieves a session ID for a message.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/String.html">string</a> GetSessionIdForMethodMessage(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> <i>msg</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>msg</i><br><dl>
<dd>
<param> The  <a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> for which a session ID is requested.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A session ID string that uniquely identifies the current session.</dd>
</dl><b>Remarks</b><dl>
<dd> The same session ID might be returned for objects in the same application, but this method will never return the same session ID for two objects in different remote applications.<p> For more information on identifying sessions and session IDs, see  the conceptual topic at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsessionstate.asp">MSDN: sessionstate</a>.</p>
</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to get the session ID string for the current session.<pre>
   public void ProcessMessageStart(IMessage requestMessage, bool bClientSide, bool bAsyncCall) {
      
      Console.WriteLine("\nProcessMessageStart");
      Console.WriteLine("requestMessage = {0}", requestMessage);
      
      try {
         Console.WriteLine("SessionId = {0}.",
             RemotingServices.GetSessionIdForMethodMessage((IMethodMessage)requestMessage));
      }
      catch (InvalidCastException) {
         Console.WriteLine("The requestMessage is not an IMethodMessage.");
      }

      IMethodCallMessage requestMethodCallMessage;
      
      try {
         requestMethodCallMessage = (IMethodCallMessage)requestMessage;
         // Prints the details of the IMethodCallMessage to the console.
         Console.WriteLine("\nMethodCall details");
         Console.WriteLine("Uri = {0}", requestMethodCallMessage.Uri);
         Console.WriteLine("TypeName = {0}", requestMethodCallMessage.TypeName);
         Console.WriteLine("MethodName = {0}", requestMethodCallMessage.MethodName);
         Console.WriteLine("ArgCount = {0}", requestMethodCallMessage.ArgCount);
         
         Console.WriteLine("MethodCall.Args");
         foreach(object o in requestMethodCallMessage.Args)
             Console.WriteLine("\t{0}", o);
         
         // Sends this method call message to another server to replicate
         // the call at the second server.
         if (requestMethodCallMessage.Uri == replicatedServiceUri) {
            
            SampleService replicationService = 
               (SampleService)Activator.GetObject(typeof(SampleService), 
               replicationServerUrl + replicatedServiceUri);
            
            IMethodReturnMessage returnMessage = 
               RemotingServices.ExecuteMessage(replicationService, requestMethodCallMessage);
            
            // Prints the results of the method call stored in the IMethodReturnMessage.
            Console.WriteLine("\nMessage returned by ExecuteMessage.");
            Console.WriteLine("\tException = {0}", returnMessage.Exception);
            Console.WriteLine("\tReturnValue = {0}", returnMessage.ReturnValue);
            Console.WriteLine("\tOutArgCount = {0}", returnMessage.OutArgCount);
            Console.WriteLine("Return message OutArgs");
            
            foreach(object o in requestMethodCallMessage.Args)
               Console.WriteLine("\t{0}", o);
         }
      }
      catch (InvalidCastException) {
          Console.WriteLine("The requestMessage is not a MethodCall");
      }
   }

    </pre>
</dd>
</dl><b>
								See also:
							</b><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconsessionstate.asp">MSDN: sessionstate</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetTypeTopic1"></a><a name="GetType">GetType</a></i></b><b><i>()</i></b><dl>
<dd><b><font color="#800080"> Inherited<br>See base class member description: <a href="../../System/types/Object.html#GetType">System.Object.GetType</a></font></b></dd>
</dl>
<dl>
<dd>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public <a href="../../System/types/Type.html">Type</a> GetType();</b></code></td>
</tr>
</table>
</dd>
</dl><br>For more information on members inherited from System.Object click on the link above.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="IsMethodOverloadedTopic1"></a><a name="IsMethodOverloaded(System.Runtime.Remoting.Messaging.IMethodMessage)">IsMethodOverloaded</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> <i>msg</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a Boolean value indicating whether the method in the given message is overloaded.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Boolean.html">bool</a> IsMethodOverloaded(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting.Messaging/types/IMethodMessage.html">IMethodMessage</a> <i>msg</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>msg</i><br><dl>
<dd>
<param> The message containing a call to the method in question.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd><b>true</b> if the method called in <i>msg</i> is overloaded; otherwise, <b>false</b>.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="IsObjectOutOfAppDomainTopic1"></a><a name="IsObjectOutOfAppDomain(System.Object)">IsObjectOutOfAppDomain</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>tp</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a Boolean value indicating whether the object specified by the given transparent proxy is contained in a different AppDomain than the object that called the current method.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Boolean.html">bool</a> IsObjectOutOfAppDomain(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>tp</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>tp</i><br><dl>
<dd>
<param> The object to check.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd><b>true</b> if the object is out of the current AppDomain; otherwise, <b>false</b>.</dd>
</dl><b>Remarks</b><dl>
<dd> For information on AppDomains see  the conceptual topic at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconApplicationDomains.asp">MSDN: applicationdomains</a>.</dd>
</dl><b>Example</b><dl>
<dd>
<pre>
			// Create a remote version of TempConverter.Converter.
			TempConverter.Converter converter1 =
					(TempConverter.Converter) Activator.GetObject(
					typeof(TempConverter.Converter),
					"http://localhost:8085/TempConverter");
			// Create a local version of TempConverter.Converter.
			TempConverter.Converter converter2 = new TempConverter.Converter();

			// Returns true, converter1 is remote and in a different appdomain.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(
									converter1); 

			// Returns false, converter2 is local and running in this appdomain.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(
									converter2); 

			// Returns true, converter1 is remote and in a different context.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfContext(
									converter1);

			// Returns false, converter2 is local and running in this context.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfContext(
									converter2);

    </pre>
</dd>
</dl><b>
								See also:
							</b><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconApplicationDomains.asp">MSDN: applicationdomains</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="IsObjectOutOfContextTopic1"></a><a name="IsObjectOutOfContext(System.Object)">IsObjectOutOfContext</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>tp</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a Boolean value indicating whether the object represented by the given proxy is contained in a different context than the object that called the current method.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Boolean.html">bool</a> IsObjectOutOfContext(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>tp</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>tp</i><br><dl>
<dd>
<param> The object to check.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd><b>true</b> if the object is out of the current context; otherwise, <b>false</b>.</dd>
</dl><b>Remarks</b><dl>
<dd> A context is an ordered sequence of properties that define an environment for the objects that reside inside it. Contexts are created during the activation process for objects that are configured to require certain automatic services such synchronization, transactions, just-in-time activation, security, and so on. Multiple objects can live inside a context.</dd>
</dl><b>Example</b><dl>
<dd>
<pre>
			// Create a remote version of TempConverter.Converter.
			TempConverter.Converter converter1 =
					(TempConverter.Converter) Activator.GetObject(
					typeof(TempConverter.Converter),
					"http://localhost:8085/TempConverter");
			// Create a local version of TempConverter.Converter.
			TempConverter.Converter converter2 = new TempConverter.Converter();

			// Returns true, converter1 is remote and in a different appdomain.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(
									converter1); 

			// Returns false, converter2 is local and running in this appdomain.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(
									converter2); 

			// Returns true, converter1 is remote and in a different context.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfContext(
									converter1);

			// Returns false, converter2 is local and running in this context.
			System.Runtime.Remoting.RemotingServices.IsObjectOutOfContext(
									converter2);

    </pre>
</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Remoting.Contexts/types/Context.html">Context</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="IsOneWayTopic1"></a><a name="IsOneWay(System.Reflection.MethodBase)">IsOneWay</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System.Reflection/types/MethodBase.html">MethodBase</a> <i>method</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a Boolean value indicating whether the client that called the method specified in the given message is waiting for the server to finish processing the method before continuing execution.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Boolean.html">bool</a> IsOneWay(<br>   <font color="#008080"><a href="../../System.Reflection/types/MethodBase.html">MethodBase</a> <i>method</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>method</i><br><dl>
<dd>
<param> The method in question.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd><b>true</b> if the method is one way; otherwise, <b>false</b>.</dd>
</dl><b>Remarks</b><dl>
<dd> When a one way method is called, the client does not wait for the server to finish processing the message. The client method returns to the application with no knowledge of whether or not the server will successfully process the message. Methods are marked as one way using the  <a href="../../System.Runtime.Remoting.Messaging/types/OneWayAttribute.html">OneWayAttribute</a>.<p> One way methods cannot have a return value or any out parameters.</p>
</dd>
</dl><b>Example</b><dl>
<dd>
<pre>
public class HelloServer : MarshalByRefObject {

   public HelloServer() {
      Console.WriteLine("HelloServer activated.");
   }

   [OneWay()]
   public void SayHelloToServer(string name) {
      Console.WriteLine("Client invoked SayHelloToServer(\"{0}\").", name);
   }   

   // Note the lack of the OneWayAttribute adornment on this method.
   public string SayHelloToServerAndWait(string name) {
      Console.WriteLine("Client invoked SayHelloToServerAndWait(\"{0}\").", name);

      Console.WriteLine(
         "Client waiting for return? {0}",
         RemotingServices.IsOneWay(MethodBase.GetCurrentMethod()) ? "No" : "Yes"
      );

      return "Hi there, " + name + ".";
   }
}

    </pre>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="IsTransparentProxyTopic1"></a><a name="IsTransparentProxy(System.Object)">IsTransparentProxy</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>proxy</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns a Boolean value indicating whether the given object is a transparent proxy or a real object.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Boolean.html">bool</a> IsTransparentProxy(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>proxy</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>proxy</i><br><dl>
<dd>
<param> The reference to the object to check.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A Boolean value indicating whether the object specified in the <i>proxy</i> parameter is a transparent proxy or a real object.</dd>
</dl><b>Remarks</b><dl>
<dd> A client that uses an object across any kind of a remoting boundary is actually using a transparent proxy for the object. The transparent proxy gives the impression that the actual object resides in the client's space. It achieves this by forwarding calls made on it to the real object using the remoting infrastructure.<p> The transparent proxy is itself housed by an instance of a managed runtime class of type  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a>. The  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> implements a part of the functionality needed to forward the operations from the transparent proxy. A proxy object inherits the associated semantics of managed objects such as garbage collection, support for fields and methods, and can be extended to form new classes. Thus the proxy has a dual nature; on the one hand it needs to act as an object of the same class as the remote object (transparent proxy), and on the other it is a managed object itself.</p>
<p> A proxy object can be used without regard to any remoting subdivisions within an  <a href="../../System/types/AppDomain.html">AppDomain</a>. Applications need not distinguish between proxy references and object references. However, service providers dealing with issues such as activation, lifetime management, and transactions need to make such distinctions.</p>
</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates the use of the  <a href="#IsTransparentProxy(System.Object)">RemotingServices.IsTransparentProxy</a> method to determine whether an object is a proxy or a real object. For the complete example code, see the example for the  <a href="../../System.Runtime.Remoting.Messaging/types/AsyncResult.html">AsyncResult</a> class.<pre>
        // Creates an instance of a context-bound type SampleSynchronized.
        SampleSyncronized sampSyncObj = new SampleSyncronized();

        // Checks whether the object is a proxy, since it is context-bound.
        if (RemotingServices.IsTransparentProxy(sampSyncObj))
            Console.WriteLine("sampSyncObj is a proxy.");
        else
            Console.WriteLine("sampSyncObj is NOT a proxy.");

    </pre>
</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="LogRemotingStageTopic1"></a><a name="LogRemotingStage(System.Int32)">LogRemotingStage</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Int32.html">int</a> <i>stage</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Public reserved method, for internal use only.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code>[Conditional("")]<br><b>public static void LogRemotingStage(<br>   <font color="#008080"><a href="../../System/types/Int32.html">int</a> <i>stage</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>stage</i><br><dl>
<dd>
<param>
</dd>
</dl>
</p>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Overloaded Method: <i><a name="MarshalTopic1"></a><a name="Marshal(System.MarshalByRefObject)">Marshal</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>Obj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Takes a  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a>, registers it with the remoting infrastructure, and converts it into an instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static ObjRef <a href="../../System.Runtime.Remoting/types/ObjRef.html">Marshal(</a> Marshal(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>Obj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>Obj</i><br><dl>
<dd>
<param> The object to convert.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> An instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class representing the object specified in the <i>Obj</i> parameter.</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System.Runtime.Remoting/types/RemotingException.html">RemotingException</a></td>
<td> The <i>Obj</i> parameter is an object proxy.</td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is a serializable representation of an object used to transfer an object reference across an AppDomain boundary. Creating an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for an object is known as marshaling. The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> can be transferred through a channel into another AppDomain (possibly on another process or computer). Once in the other AppDomain, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> must be parsed to create a proxy for the object, generally connected to the real object. This operation is known as unmarshaling. <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> s contain information that describes the  <a href="../../System/types/Type.html">Type</a> and class of the object being marshaled, a URI that uniquely identifies the specific object instance, and communication related information on how to reach the remoting subdivision where the object is located.<p> During marshaling, the context from the current thread is used, not the context that was active when the object was created. If a URI was not explicitly set by the  <a href="#SetObjectUriForMarshal(System.MarshalByRefObject,System.String)">RemotingServices.SetObjectUriForMarshal</a> method, it is automatically generated by the remoting identity infrastructure.</p>
<p> You cannot associate a URI with a proxy for one of two reasons: either the URI was generated at the server side for the object it represents, or the object is well known, in which case the URI is known. For this reason, if the <i>Obj</i> parameter is a proxy, an exception will be thrown. For custom proxies this restriction is relaxed because the transparent proxy is treated as the server object.</p>
</dd>
</dl><b>.NET Framework Security:</b><dl>
<dd> <a href="../../System.Security.Permissions/types/SecurityPermission.html">SecurityPermission</a> for configuration of the remoting infrastructure. Associated enumeration:  <a href="../../System.Security.Permissions/types/SecurityPermissionFlag.html#RemotingConfiguration">SecurityPermissionFlag.RemotingConfiguration</a>.</dd>
</dl><b>See also: 
			</b><br> <a href="../../System/types/Uri.html">Uri</a> | <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconApplicationDomains.asp">MSDN: applicationdomains</a> |  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Overloaded Method: <i><a name="MarshalTopic2"></a><a name="Marshal(System.MarshalByRefObject,System.String)">Marshal</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>Obj</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>URI</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Converts the given  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> into an instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class with the specified URI.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static ObjRef <a href="../../System.Runtime.Remoting/types/ObjRef.html">Marshal(</a> Marshal(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>Obj</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>URI</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>Obj</i><br><dl>
<dd>
<param> The object to convert.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>URI</i><br><dl>
<dd>
<param> The specified URI with which to initialize the new  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a>. Can be <b>null</b>.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> An instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class representing the object specified in the <i>Obj</i> parameter.</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System.Runtime.Remoting/types/RemotingException.html">RemotingException</a></td>
<td><i>Obj</i> is an object proxy, and the <i>URI</i> parameter is not <b>null</b>.</td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is a serializable representation of an object used to transfer an object reference across an AppDomain boundary. Creating an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for an object is known as marshaling. The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> can be transferred through a channel into another AppDomain (possibly on another process or computer). Once in the other AppDomain, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> must be parsed to create a proxy for the object, generally connected to the real object. This operation is known as unmarshaling. <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> s contain information that describes the  <a href="../../System/types/Type.html">Type</a> and class of the object being marshaled, a URI that uniquely identifies the specific object instance, and communication related information on how to reach the remoting subdivision where the object is located.<p> During marshaling, the context from the current thread is used, not the context that was active when the object was created.</p>
<p> You cannot associate a URI with a proxy for one of two reasons: either the URI was generated at the server side for the object it represents, or the object is well known, in which case the URI is known. For this reason, if the <i>Obj</i> parameter is a proxy, an exception will be thrown. For custom proxies this restriction is relaxed because the transparent proxy is treated as the server object.</p>
</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to use the current  <a href="#Marshal(System.MarshalByRefObject)">RemotingServices.Marshal</a> method to marshal a specified object.<pre>
      TcpChannel channel = new TcpChannel(9000);
      ChannelServices.RegisterChannel(channel);

      SampleWellKnown objectWellKnown = new SampleWellKnown();
      
      // After the channel is registered, the object needs to be registered
      // with the remoting infrastructure.  So, Marshal is called.
      ObjRef objrefWellKnown = RemotingServices.Marshal(objectWellKnown, "objectWellKnownUri");
      Console.WriteLine("An instance of SampleWellKnown type is published at {0}.", objrefWellKnown.URI);

      Console.WriteLine("Press enter to unregister SampleWellKnown, so that it is no longer available on this channel.");
      Console.ReadLine();
      RemotingServices.Disconnect(objectWellKnown);

      Console.WriteLine("Press enter to end the server process.");
      Console.ReadLine();

    </pre>
</dd>
</dl><b>.NET Framework Security:</b><dl>
<dd> <a href="../../System.Security.Permissions/types/SecurityPermission.html">SecurityPermission</a> for configuration of the remoting infrastructure. Associated enumeration:  <a href="../../System.Security.Permissions/types/SecurityPermissionFlag.html#RemotingConfiguration">SecurityPermissionFlag.RemotingConfiguration</a>.</dd>
</dl><b>See also: 
			</b><br> <a href="../../System/types/Uri.html">Uri</a> | <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconApplicationDomains.asp">MSDN: applicationdomains</a> |  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Overloaded Method: <i><a name="MarshalTopic3"></a><a name="Marshal(System.MarshalByRefObject,System.String,System.Type)">Marshal</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>Obj</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>ObjURI</i>,</font><br>   <font color="#008080"><a href="../../System/types/Type.html">Type</a> <i>RequestedType</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Takes a  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> and converts it into an instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class with the specified URI, and the provided  <a href="../../System/types/Type.html">Type</a>.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static ObjRef <a href="../../System.Runtime.Remoting/types/ObjRef.html">Marshal(</a> Marshal(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>Obj</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>ObjURI</i>,</font><br>   <font color="#008080"><a href="../../System/types/Type.html">Type</a> <i>RequestedType</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>Obj</i><br><dl>
<dd>
<param> The object to convert into an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a>.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>ObjURI</i><br><dl>
<dd>
<param> The URI the object specified in the <i>Obj</i> parameter is marshaled with. Can be <b>null</b>.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>RequestedType</i><br><dl>
<dd>
<param> The  <a href="../../System/types/Type.html">Type</a><i>Obj</i> is marshaled as. Can be <b>null</b>.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> An instance of the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> class representing the object specified in the <i>Obj</i> parameter.</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System.Runtime.Remoting/types/RemotingException.html">RemotingException</a></td>
<td><i>Obj</i> is a proxy of a remote object, and the <i>ObjUri</i> parameter is not <b>null</b>.</td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is a serializable representation of an object used to transfer an object reference across an AppDomain boundary. Creating an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for an object is known as marshaling. The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> can be transferred through a channel into another AppDomain (possibly on another process or computer). Once in the other AppDomain, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> must be parsed to create a proxy for the object, generally connected to the real object. This operation is known as unmarshaling. <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> s contain information that describes the  <a href="../../System/types/Type.html">Type</a> and class of the object being marshaled, a URI that uniquely identifies the specific object instance, and communication related information on how to reach the remoting subdivision where the object is located.<p> The specified  <a href="../../System/types/Type.html">Type</a> is used by the remoting infrastructure to limit the scope of the exposed type hierarchy. For example, if object A derives from object B, which derives from object C, and  <a href="#Marshal(System.MarshalByRefObject)">RemotingServices.Marshal</a> is called, then the client can cast the proxy between C and B but not to A.</p>
<p> During marshaling, the context from the current thread is used, not the context that was active when the object was created.</p>
<p> You cannot associate a URI with a proxy for one of two reasons: either the URI was generated at the server side for the object it represents, or the object is well known, in which case the URI is known. For this reason, if the <i>Obj</i> parameter is a proxy, an exception will be thrown. For custom proxies this restriction is relaxed because the transparent proxy is treated as the server object.</p>
</dd>
</dl><b>.NET Framework Security:</b><dl>
<dd> <a href="../../System.Security.Permissions/types/SecurityPermission.html">SecurityPermission</a> for configuration of the remoting infrastructure. Associated enumeration:  <a href="../../System.Security.Permissions/types/SecurityPermissionFlag.html#RemotingConfiguration">SecurityPermissionFlag.RemotingConfiguration</a>.</dd>
</dl><b>See also: 
			</b><br> <a href="../../System/types/Uri.html">Uri</a> | <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconApplicationDomains.asp">MSDN: applicationdomains</a> |  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="MemberwiseCloneTopic1"></a><a name="MemberwiseClone">MemberwiseClone</a></i></b><b><i>()</i></b><dl>
<dd><b><font color="#800080"> Inherited<br>See base class member description: <a href="../../System/types/Object.html#MemberwiseClone">System.Object.MemberwiseClone</a></font></b></dd>
</dl>
<dl>
<dd>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            protected <a href="../../System/types/Object.html">object</a> MemberwiseClone();</b></code></td>
</tr>
</table>
</dd>
</dl><br>For more information on members inherited from System.Object click on the link above.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="SetObjectUriForMarshalTopic1"></a><a name="SetObjectUriForMarshal(System.MarshalByRefObject,System.String)">SetObjectUriForMarshal</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>uri</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Sets the URI for the subsequent call to the  <a href="#Marshal(System.MarshalByRefObject)">RemotingServices.Marshal</a> method.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static void SetObjectUriForMarshal(<br>   <font color="#008080"><a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a> <i>obj</i>,</font><br>   <font color="#008080"><a href="../../System/types/String.html">string</a> <i>uri</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>obj</i><br><dl>
<dd>
<param> The object to set a URI for.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>uri</i><br><dl>
<dd>
<param> The URI to assign to the specified object.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System.Runtime.Remoting/types/RemotingException.html">RemotingException</a></td>
<td><i>obj</i> is not a local object, has already been marshaled, or the current method has already been called on.</td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> The URI set by the current method is used when marshaling the given object.<br><br><b>Note </b> After marshaling, the URI of the specified object is set to the string in the <i>uri</i> parameter appended onto the  <a href="../../System/types/Guid.html">Guid</a> of the current  <a href="../../System/types/AppDomain.html">AppDomain</a>.<br><br><b>Note </b> If the current application is listening on an HTTP port, then both the string specified in the <i>uri</i> parameter and the <i>uri</i> string appended onto the  <a href="../../System/types/Guid.html">Guid</a> of the current  <a href="../../System/types/AppDomain.html">AppDomain</a> route to the specified object. For example, if the application is listening on HTTP port 9000, then both http://localhost:9000/objectUri, and http://localhost:9000/&lt;appdomainguid&gt;/objectUri route to the object specified in the <i>obj</i> parameter.</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to set the URI that will be used by the  <a href="#Marshal(System.MarshalByRefObject)">RemotingServices.Marshal</a> method when marshaling the specified object.<pre>
using System;
using System.Runtime.Remoting;

public class SetObjectUriForMarshalTest  {

    class TestClass : MarshalByRefObject {
    }

    public static void Main()  {

        TestClass obj = new TestClass();    

        RemotingServices.SetObjectUriForMarshal(obj, "testUri");
        RemotingServices.Marshal(obj);

        Console.WriteLine(RemotingServices.GetObjectUri(obj));
    }
}

    </pre>
</dd>
</dl><b>.NET Framework Security:</b><dl>
<dd> <a href="../../System.Security.Permissions/types/SecurityPermission.html">SecurityPermission</a> for configuration of the remoting infrastructure. Associated enumeration:  <a href="../../System.Security.Permissions/types/SecurityPermissionFlag.html#RemotingConfiguration">SecurityPermissionFlag.RemotingConfiguration</a>.</dd>
</dl><b>See also: 
			</b><br> <a href="../../System/types/Uri.html">Uri</a> |  <a href="../../System/types/Guid.html">Guid</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="ToStringTopic1"></a><a name="ToString">ToString</a></i></b><b><i>()</i></b><dl>
<dd><b><font color="#800080"> Inherited<br>See base class member description: <a href="../../System/types/Object.html#ToString">System.Object.ToString</a></font></b></dd>
</dl>
<dl>
<dd>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public virtual string ToString();</b></code></td>
</tr>
</table>
</dd>
</dl><br>For more information on members inherited from System.Object click on the link above.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Overloaded Method: <i><a name="UnmarshalTopic1"></a><a name="Unmarshal(System.Runtime.Remoting.ObjRef)">Unmarshal</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> <i>objectRef</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Takes an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> and creates a proxy object out of it.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Object.html">object</a> Unmarshal(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> <i>objectRef</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>objectRef</i><br><dl>
<dd>
<param> The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> that represents the remote object for which the proxy is being created.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A proxy to the object that the given  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> represents.</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentException.html">ArgumentException</a></td>
<td> The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> instance specified in the <i>objectRef</i> parameter is not well formed.</td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is a serializable representation of an object used to transfer an object reference across an AppDomain boundary. Creating an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for an object is known as marshaling. The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> can be transferred through a channel into another AppDomain (possibly on another process or computer). Once in the other AppDomain, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> must be parsed to create a proxy for the object, generally connected to the real object. This operation is known as unmarshaling. During unmarshaling, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is parsed to extract the method information of the remote object and both the transparent proxy and  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> objects are created. The content of the parsed  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is added to the transparent proxy before the transparent proxy is registered with the common language runtime.<p> <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> s contain information that describes the  <a href="../../System/types/Type.html">Type</a> and class of the object being marshaled, a URI that uniquely identifies the specific object instance, and communication related information on how to reach the remoting subdivision where the object is located.</p>
</dd>
</dl><b>Example</b><dl>
<dd> The following example demonstrates how to unmarshal an object.<pre>
        ChannelServices.RegisterChannel(new HttpChannel());

        SampleService objectSample = (SampleService)Activator.GetObject(typeof(SampleService), 
            "http://localhost:9000/MySampleService/SampleService.soap");

        // The GetManuallyMarshaledObject() method uses RemotingServices.Marshal()
        // to create an ObjRef object for a SampleTwo object.
        ObjRef objRefSampleTwo = objectSample.GetManuallyMarshaledObject();

        SampleTwo objectSampleTwo = (SampleTwo)RemotingServices.Unmarshal(objRefSampleTwo);

        objectSampleTwo.PrintMessage("ObjRef successfuly unmarshaled."); 

    </pre>
</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Overloaded Method: <i><a name="UnmarshalTopic2"></a><a name="Unmarshal(System.Runtime.Remoting.ObjRef,System.Boolean)">Unmarshal</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> <i>objectRef</i>,</font><br>   <font color="#008080"><a href="../../System/types/Boolean.html">bool</a> <i>fRefine</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Takes an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> and creates a proxy object out of it, refining it to the type on the server.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            public static <a href="../../System/types/Object.html">object</a> Unmarshal(<br>   <font color="#008080"><a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> <i>objectRef</i>,</font><br>   <font color="#008080"><a href="../../System/types/Boolean.html">bool</a> <i>fRefine</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>objectRef</i><br><dl>
<dd>
<param> The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> that represents the remote object for which the proxy is being created.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>fRefine</i><br><dl>
<dd>
<param><b>true</b> to refine the proxy to the type on the server; otherwise, <b>false</b>.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> A proxy to the object that the given  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> represents.</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentException.html">ArgumentException</a></td>
<td> The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> instance specified in the <i>objectRef</i> parameter is not well formed.</td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> An  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is a serializable representation of an object used to transfer an object reference across an AppDomain boundary. Creating an  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> for an object is known as marshaling. The  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> can be transferred through a channel into another AppDomain (possibly on another process or computer). Once in the other AppDomain, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> must be parsed to create a proxy for the object, generally connected to the real object. This operation is known as unmarshaling. During unmarshaling, the  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is parsed to extract the method information of the remote object and both the transparent proxy and  <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> objects are created. The content of the parsed  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> is added to the transparent proxy before the transparent proxy is registered with the common language runtime.<p> <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a> s contain information that describes the  <a href="../../System/types/Type.html">Type</a> and class of the object being marshaled, a URI that uniquely identifies the specific object instance, and communication related information on how to reach the remoting subdivision where the object is located.</p>
<p> When first created, the proxy is of type  <a href="../../System/types/MarshalByRefObject.html">MarshalByRefObject</a>. As you cast it into different types, the remoting infrastructure keeps track of the most used type to avoid loading the type unnecessarily.</p>
</dd>
</dl><b>See also: 
			</b><br> <a href="../../System.Runtime.Remoting.Proxies/types/RealProxy.html">RealProxy</a> |  <a href="../../System.Runtime.Remoting/types/ObjRef.html">ObjRef</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite">
<h3 align="center"><a href="#TopOfPage">
					Top of page
				</a></h3><i><a href="../../documentation_license.txt">
				  Copyright (c) 2002 Microsoft Corporation.  All rights reserved.
				</a></i></body>
</html>
