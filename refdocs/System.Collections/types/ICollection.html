<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../refdoc.css">
<title>Type: System.Collections.ICollection</title>
</head>
<body><a name="TopOfPage"></a><h2>System.Collections.ICollection Interface</h2><b>Assembly: </b>Mscorlib.dll<br><b>Namespace: </b>System.Collections<br><dl>
<dt><b>Summary</b></dt>
<dd> Defines size, enumerators and synchronization methods for all collections.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
        public interface ICollection : IEnumerable
      </b></code></td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> The  <a href="../../System.Collections/types/ICollection.html">ICollection</a> interface is the base interface for classes in the  <a href="../../System.Collections/System.Collections.html">System.Collections</a> namespace.<p> <a href="../../System.Collections/types/IDictionary.html">IDictionary</a> and  <a href="../../System.Collections/types/IList.html">IList</a> are more specialized interfaces that are based on the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> interface. An  <a href="../../System.Collections/types/IDictionary.html">IDictionary</a> implementation is a collection of key-and-value pairs, like the  <a href="../../System.Collections/types/Hashtable.html">Hashtable</a> class. An  <a href="../../System.Collections/types/IList.html">IList</a> implementation is a collection of values that can be sorted and whose members can be accessed by index, like the  <a href="../../System.Collections/types/ArrayList.html">ArrayList</a> class.</p>
<p> Some collections that limit access to their elements, like the  <a href="../../System.Collections/types/Queue.html">Queue</a> class and the  <a href="../../System.Collections/types/Stack.html">Stack</a> class, directly implement the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> interface.</p>
<p> If neither the  <a href="../../System.Collections/types/IDictionary.html">IDictionary</a> interface nor the  <a href="../../System.Collections/types/IList.html">IList</a> interface meet the requirements of the required collection, derive the new collection class from the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> interface instead for more flexibility.</p>
</dd>
</dl><b>See also: </b><dl>
<dd> <a href="../../System.Collections/System.Collections.html">System.Collections Namespace</a> |  <a href="../../System.Collections/types/IDictionary.html">IDictionary</a> |  <a href="../../System.Collections/types/IList.html">IList</a></dd>
</dl>
<h3>System.Collections.ICollection Member List: </h3>
<dl>
<dt><b>Public Properties</b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<td width="35%"><a href="#Count">Count</a></td>
<td width="55%"><b>Read-only</b><br><br> When implemented by a class, gets the number of elements contained in the  <a href="../../System.Collections/types/ICollection.html">ICollection</a>.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#IsSynchronized">IsSynchronized</a></td>
<td width="55%"><b>Read-only</b><br><br> When implemented by a class, gets a value indicating whether access to the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> is synchronized (thread-safe).</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#SyncRoot">SyncRoot</a></td>
<td width="55%"><b>Read-only</b><br><br> When implemented by a class, gets an object that can be used to synchronize access to the  <a href="../../System.Collections/types/ICollection.html">ICollection</a>.</td>
</tr>
</table>
</dd>
</dl>
<dl>
<dt><b>Public Methods</b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<td width="35%"><a href="#CopyTo(System.Array,System.Int32)">CopyTo</a></td>
<td width="55%"> When implemented by a class, copies the elements of the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> to an  <a href="../../System/types/Array.html">Array</a>, starting at a particular  <a href="../../System/types/Array.html">Array</a> index.</td>
</tr>
</table>
</dd>
</dl>
<p><b>Hierarchy:</b><ul class="none">
<li><a href="../../System.Collections/types/IEnumerable.html">System.Collections.IEnumerable</a></li>
<ul class="none">
<li><b>System.Collections.ICollection</b></li>
</ul>
</ul>
</p>
<hr>
<h3>System.Collections.ICollection Member Details</h3><b>Property: <i><a name="CountTopic1"></a><a name="Count">Count</a></i></b><b><i></i></b><b><font color="#008080"> (read-only)</font></b><br><dl>
<dt><b>Summary</b></dt>
<dd> When implemented by a class, gets the number of elements contained in the  <a href="../../System.Collections/types/ICollection.html">ICollection</a>.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            <a href="../../System/types/Int32.html">int</a> Count {get;}
          </b></code></td>
</tr>
</table>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Property: <i><a name="IsSynchronizedTopic1"></a><a name="IsSynchronized">IsSynchronized</a></i></b><b><i></i></b><b><font color="#008080"> (read-only)</font></b><br><dl>
<dt><b>Summary</b></dt>
<dd> When implemented by a class, gets a value indicating whether access to the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> is synchronized (thread-safe).</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            <a href="../../System/types/Boolean.html">bool</a> IsSynchronized {get;}
          </b></code></td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> <a href="#SyncRoot">ICollection.SyncRoot</a> returns an object, which can be used to synchronize access to the  <a href="../../System.Collections/types/ICollection.html">ICollection</a>.<p> Most collection classes in the  <a href="../../System.Collections/System.Collections.html">System.Collections</a> namespace also implement a Synchronized method, which provides a synchronized wrapper around the underlying collection.</p>
<p> Enumerating through a collection is intrinsically not a thread-safe procedure. Even when a collection is synchronized, other threads could still modify the collection, which causes the enumerator to throw an exception. To guarantee thread safety during enumeration, you can either lock the collection during the entire enumeration or catch the exceptions resulting from changes made by other threads.</p>
<p> The following code example shows how to lock the collection using the  <a href="#SyncRoot">ICollection.SyncRoot</a> during the entire enumeration: </p>
<pre>
              ICollection myCollection = new ICollection();
               lock( myCollection.SyncRoot ) {
               foreach ( Object item in myCollection ) {
               // Insert your code here.
               }
              }
            </pre>
</dd>
</dl><b>See also: 
			</b><br> <a href="#SyncRoot">ICollection.SyncRoot</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Property: <i><a name="SyncRootTopic1"></a><a name="SyncRoot">SyncRoot</a></i></b><b><i></i></b><b><font color="#008080"> (read-only)</font></b><br><dl>
<dt><b>Summary</b></dt>
<dd> When implemented by a class, gets an object that can be used to synchronize access to the  <a href="../../System.Collections/types/ICollection.html">ICollection</a>.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            <a href="../../System/types/Object.html">object</a> SyncRoot {get;}
          </b></code></td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> For collections whose underlying store is not publicly available, the expected implementation is to return the current instance. Note that the pointer to the current instance might not be sufficient for collections that wrap other collections; those should return the underlying collection's <b>SyncRoot</b> property.<p> Most collection classes in the  <a href="../../System.Collections/System.Collections.html">System.Collections</a> namespace also implement a <b>Synchronized</b> method, which provides a synchronized wrapper around the underlying collection. However, derived classes can provide their own synchronized version of the collection using the  <a href="#SyncRoot">ICollection.SyncRoot</a> property. The synchronizing code must perform operations on the  <a href="#SyncRoot">ICollection.SyncRoot</a> of the collection, not directly on the collection. This ensures proper operation of collections that are derived from other objects. Specifically, it maintains proper synchronization with other threads that might be simultaneously modifying the collection instance.</p>
<p> In the absence of a <b>Synchronized</b> method on a collection, the expected usage for  <a href="#SyncRoot">ICollection.SyncRoot</a> looks like this: </p>
<pre>
              ICollection MyCollection = ...
              lock( MyCollection.SyncRoot ) {
               // Some operation on the collection, which is now thread-safe.
              }
            </pre>
<p> Enumerating through a collection is intrinsically not a thread-safe procedure. Even when a collection is synchronized, other threads could still modify the collection, which causes the enumerator to throw an exception. To guarantee thread safety during enumeration, you can either lock the collection during the entire enumeration or catch the exceptions resulting from changes made by other threads.</p>
<p> The following code example shows how to lock the collection using the  <a href="#SyncRoot">ICollection.SyncRoot</a> during the entire enumeration: </p>
<pre>
              ICollection myCollection = new ICollection();
              lock( myCollection.SyncRoot ) {
               foreach ( Object item in myCollection ) {
               // Insert your code here.
               }
              }
            </pre>
</dd>
</dl><b>See also: 
			</b><br> <a href="#IsSynchronized">ICollection.IsSynchronized</a><h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="CopyToTopic1"></a><a name="CopyTo(System.Array,System.Int32)">CopyTo</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Array.html">Array</a> <i>array</i>,</font><br>   <font color="#008080"><a href="../../System/types/Int32.html">int</a> <i>index</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> When implemented by a class, copies the elements of the  <a href="../../System.Collections/types/ICollection.html">ICollection</a> to an  <a href="../../System/types/Array.html">Array</a>, starting at a particular  <a href="../../System/types/Array.html">Array</a> index.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            void CopyTo(<br>   <font color="#008080"><a href="../../System/types/Array.html">Array</a> <i>array</i>,</font><br>   <font color="#008080"><a href="../../System/types/Int32.html">int</a> <i>index</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>array</i><br><dl>
<dd>
<param> The one-dimensional  <a href="../../System/types/Array.html">Array</a> that is the destination of the elements copied from  <a href="../../System.Collections/types/ICollection.html">ICollection</a>. The  <a href="../../System/types/Array.html">Array</a> must have zero-based indexing.
</dd>
</dl>
</p>
</dd>
<dd>
<p><i>index</i><br><dl>
<dd>
<param> The zero-based index in <i>array</i> at which copying begins.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Exceptions </b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<th width="30%">Exception Type</th>
<th width="60%">Condition</th>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentNullException.html">ArgumentNullException</a></td>
<td><i>array</i> is <b>null</b>.</td>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentOutOfRangeException.html">ArgumentOutOfRangeException</a></td>
<td><i>index</i> is less than zero.</td>
</tr>
<tr valign="top">
<td> <a href="../../System/types/ArgumentException.html">ArgumentException</a></td>
<td><i>array</i> is multidimensional.<p> -or- </p>
<p><i>index</i> is equal to or greater than the length of <i>array</i>.</p>
<p> -or- </p>
<p> The number of elements in the source  <a href="../../System.Collections/types/ICollection.html">ICollection</a> is greater than the available space from <i>index</i> to the end of the destination <i>array</i>.</p>
</td>
</tr>
<tr valign="top">
<td> <a href="../../System/types/InvalidCastException.html">InvalidCastException</a></td>
<td> The type of the source  <a href="../../System.Collections/types/ICollection.html">ICollection</a> cannot be cast automatically to the type of the destination <i>array</i>.</td>
</tr>
</table>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite">
<h3 align="center"><a href="#TopOfPage">
					Top of page
				</a></h3><i><a href="../../documentation_license.txt">
				  Copyright (c) 2002 Microsoft Corporation.  All rights reserved.
				</a></i></body>
</html>
