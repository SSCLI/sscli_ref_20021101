<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../refdoc.css">
<title>Type: System.Runtime.InteropServices.ICustomMarshaler</title>
</head>
<body><a name="TopOfPage"></a><h2>System.Runtime.InteropServices.ICustomMarshaler Interface</h2><b>Assembly: </b>Mscorlib.dll<br><b>Namespace: </b>System.Runtime.InteropServices<br><dl>
<dt><b>Summary</b></dt>
<dd> Designed to provide custom wrappers for handling method calls.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
        public interface ICustomMarshaler
      </b></code></td>
</tr>
</table>
</dd>
</dl><b>Remarks</b><dl>
<dd> To use a custom marshaler, you must apply the  <a href="../../System.Runtime.InteropServices/types/MarshalAsAttribute.html">MarshalAsAttribute</a> to the parameter or field being marshaled. You must also pass  <a href="../../System.Runtime.InteropServices/types/UnmanagedType.html#CustomMarshaler">UnmanagedType.CustomMarshaler</a> to its constructor and specify the  <a href="../../System.Runtime.InteropServices/types/MarshalAsAttribute.html#MarshalType">MarshalAsAttribute.MarshalType</a>. The attribute identifies the appropriate custom marshaler to activate the appropriate wrapper. The common language runtime's interop service then examines the attribute and creates the custom marshaler when the argument is marshaled. It calls on the custom marshaler's  <a href="#MarshalNativeToManaged(System.IntPtr)">ICustomMarshaler.MarshalNativeToManaged</a> and  <a href="#MarshalManagedToNative(System.Object)">ICustomMarshaler.MarshalManagedToNative</a> methods to activate the correct wrapper to handle the call.<p> In addition to implementing the <b>ICustomMarshaler</b> interface, custom marshalers must implement a <b>static</b> method called <b>GetInstance</b> that accepts a  <a href="../../System/types/String.html">String</a> as a parameter and has a return type of <b>ICustomMarshaler</b>. This <b>static</b> method is called by the common language runtime's COM interop layer to instantiate an instance of the custom marshaler. The <b>String</b> passed to <b>GetInstance</b> is a cookie that the method can use to customize the returned custom marshaler.</p>
</dd>
</dl><b>See also: </b><dl>
<dd> <a href="../../System.Runtime.InteropServices/System.Runtime.InteropServices.html">System.Runtime.InteropServices Namespace</a></dd>
</dl>
<h3>System.Runtime.InteropServices.ICustomMarshaler Member List: </h3>
<dl>
<dt><b>Public Methods</b></dt>
<dd>
<table border="1" width="90%" style="border-collapse: collapse">
<tr valign="top">
<td width="35%"><a href="#CleanUpManagedData(System.Object)">CleanUpManagedData</a></td>
<td width="55%"></td>
</tr>
<tr valign="top">
<td width="35%"><a href="#CleanUpNativeData(System.IntPtr)">CleanUpNativeData</a></td>
<td width="55%"> Performs necessary cleanup of the unmanaged data when it is no longer needed.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#GetNativeDataSize">GetNativeDataSize</a></td>
<td width="55%"> Returns the size of the native data to be marshaled.</td>
</tr>
<tr valign="top">
<td width="35%"><a href="#MarshalManagedToNative(System.Object)">MarshalManagedToNative</a></td>
<td width="55%"></td>
</tr>
<tr valign="top">
<td width="35%"><a href="#MarshalNativeToManaged(System.IntPtr)">MarshalNativeToManaged</a></td>
<td width="55%"></td>
</tr>
</table>
</dd>
</dl>
<hr>
<h3>System.Runtime.InteropServices.ICustomMarshaler Member Details</h3><b>Method: <i><a name="CleanUpManagedDataTopic1"></a><a name="CleanUpManagedData(System.Object)">CleanUpManagedData</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>ManagedObj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Performs necessary cleanup of the managed data when it is no longer needed.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            void CleanUpManagedData(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>ManagedObj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>ManagedObj</i><br><dl>
<dd>
<param> The managed object to be destroyed.
</dd>
</dl>
</p>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="CleanUpNativeDataTopic1"></a><a name="CleanUpNativeData(System.IntPtr)">CleanUpNativeData</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/IntPtr.html">IntPtr</a> <i>pNativeData</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Performs necessary cleanup of the unmanaged data when it is no longer needed.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            void CleanUpNativeData(<br>   <font color="#008080"><a href="../../System/types/IntPtr.html">IntPtr</a> <i>pNativeData</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>pNativeData</i><br><dl>
<dd>
<param> A pointer to the unmanaged data to be destroyed.
</dd>
</dl>
</p>
</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="GetNativeDataSizeTopic1"></a><a name="GetNativeDataSize">GetNativeDataSize</a></i></b><b><i>()</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Returns the size of the native data to be marshaled.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            <a href="../../System/types/Int32.html">int</a> GetNativeDataSize();</b></code></td>
</tr>
</table>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> The size in bytes of the native data.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="MarshalManagedToNativeTopic1"></a><a name="MarshalManagedToNative(System.Object)">MarshalManagedToNative</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>ManagedObj</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Converts the managed data to unmanaged data.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            <a href="../../System/types/IntPtr.html">IntPtr</a> MarshalManagedToNative(<br>   <font color="#008080"><a href="../../System/types/Object.html">object</a> <i>ManagedObj</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>ManagedObj</i><br><dl>
<dd>
<param> The managed object to be converted.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> Returns the COM view of the managed object.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite"><b>Method: <i><a name="MarshalNativeToManagedTopic1"></a><a name="MarshalNativeToManaged(System.IntPtr)">MarshalNativeToManaged</a></i></b><b><i>(<br>   <font color="#008080"><a href="../../System/types/IntPtr.html">IntPtr</a> <i>pNativeData</i></font><br>)</i></b><dl>
<dt><b>Summary</b></dt>
<dd> Converts the unmanaged data to managed data.</dd>
</dl>
<dl>
<dt><b>C# Syntax:</b></dt>
<dd>
<table border="1" class="syntax" width="90%" style="border-collapse: collapse">
<tr>
<td><code><b>
            <a href="../../System/types/Object.html">object</a> MarshalNativeToManaged(<br>   <font color="#008080"><a href="../../System/types/IntPtr.html">IntPtr</a> <i>pNativeData</i></font><br>);</b></code></td>
</tr>
</table>
</dd>
</dl><b>Parameters:</b><br><dl>
<dd>
<p><i>pNativeData</i><br><dl>
<dd>
<param> A pointer to the unmanaged data to be wrapped.
</dd>
</dl>
</p>
</dd>
</dl>
<dl>
<dt><b>Return Value: </b></dt>
<dd> Returns the managed view of the COM data.</dd>
</dl>
<h4 align="center"><a href="#TopOfPage" class="top">
						Return to top
					</a></h4>
<hr class="lite">
<h3 align="center"><a href="#TopOfPage">
					Top of page
				</a></h3><i><a href="../../documentation_license.txt">
				  Copyright (c) 2002 Microsoft Corporation.  All rights reserved.
				</a></i></body>
</html>
